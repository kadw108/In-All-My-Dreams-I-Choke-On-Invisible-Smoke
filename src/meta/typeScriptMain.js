var mainScript=(()=>{var d=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var L=(e,t)=>{for(var n in t)d(e,n,{get:t[n],enumerable:!0})},A=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of w(t))!x.call(e,r)&&r!==n&&d(e,r,{get:()=>t[r],enumerable:!(i=E(t,r))||i.enumerable});return e};var N=e=>A(d({},"__esModule",{value:!0}),e);var I={};L(I,{addArrow:()=>h,addMenuPanels:()=>y,addNpc:()=>v,addReplaceLink:()=>g,addWrapperHtml:()=>m});var f=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","animation","audio","canvas","circle","clipPath","color-profile","cursor","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","handler","hkern","iframe","image","line","linearGradient","listener","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","prefetch","radialGradient","rect","script","set","solidColor","stop","style","svg","switch","symbol","tbreak","text","textArea","textPath","title","tref","tspan","unknown","use","video","view","vkern"];var c=new Set(f);c.delete("a");c.delete("audio");c.delete("canvas");c.delete("iframe");c.delete("script");c.delete("video");var S=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,B=e=>e===DocumentFragment,C=(e,t)=>{for(let[n,i]of Object.entries(t))n.startsWith("-")?e.style.setProperty(n,i):typeof i=="number"&&!S.test(n)?e.style[n]=`${i}px`:e.style[n]=i},P=e=>typeof e=="string"?c.has(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e):B(e)?document.createDocumentFragment():e(e.defaultProps),u=(e,t,n)=>{n!=null&&(/^xlink[AHRST]/.test(t)?e.setAttributeNS("http://www.w3.org/1999/xlink",t.replace("xlink","xlink:").toLowerCase(),n):e.setAttribute(t,n))},p=(e,t)=>{for(let n of t)n instanceof Node?e.appendChild(n):Array.isArray(n)?p(e,n):typeof n!="boolean"&&typeof n<"u"&&n!==null&&e.appendChild(document.createTextNode(n))},D=new Set(["contentEditable","draggable","spellCheck","value","autoReverse","externalResourcesRequired","focusable","preserveAlpha"]),a=(e,t,...n)=>{var i;let r=P(e);if(p(r,n),r instanceof DocumentFragment||!t)return r;for(let[o,l]of Object.entries(t))if(o==="htmlFor"&&(o="for"),o==="class"||o==="className"){let s=(i=r.getAttribute("class"))!==null&&i!==void 0?i:"";u(r,"class",(s+" "+String(l)).trim())}else if(o==="style")C(r,l);else if(o.startsWith("on")){let s=o.slice(2).toLowerCase().replace(/^-/,"");r.addEventListener(s,l)}else o==="dangerouslySetInnerHTML"&&"__html"in l?r.innerHTML=l.__html:o!=="key"&&(D.has(o)||l!==!1)&&u(r,o,l===!0?"":l);return r};function m(){if(document.getElementById("contents")===null){let e=document.getElementById("iff-snippet");if(e===null){console.error("iffSnippet is null");return}e.remove();let t=a("div",{id:"contents"},a("div",{id:"bg",className:"fullscreenBg"}),a("div",{id:"screenCover",className:"fullscreenBg"}),a("div",{id:"passages"},a("div",{id:"screenBg"}),a("div",{id:"screenContents",className:"absoluteAlign"},e)));document.getElementById("iff-story")?.appendChild(t)}}function M(e){let t=e.target.getAttribute("identifier"),n=document.querySelectorAll(".linkReplacer[identifier='"+t+"']");if(n.length===0){console.error("Replacelink without replacer! Identifier "+t),console.error(e.target);return}n.forEach(r=>{r.classList.contains("hidden")&&r.classList.remove("hidden")}),document.querySelectorAll(".removedOnClick[identifier='"+t+"']").forEach(r=>{r.classList.add("hidden")})}function T(e){let t=e.target.getAttribute("identifier"),n=document.querySelectorAll(".linkReplacer[identifier='"+t+"']");if(n.length===0){console.error("Replacelink without replacer! Identifier "+t),console.error(e.target);return}n.forEach(r=>{r.classList.contains("hidden")||r.classList.add("hidden")}),document.querySelectorAll(".removedOnClick[identifier='"+t+"']").forEach(r=>{r.classList.remove("hidden")})}function g(){Array.from(document.getElementsByClassName("linkReplaced")).forEach(e=>{e.addEventListener("click",M)}),Array.from(document.getElementsByClassName("linkHider")).forEach(e=>{e.addEventListener("click",T)})}function O(e){if(e.target===null)return;let t=e.target.getAttribute("identifier"),n=document.querySelector(".panelFull[identifier='"+t+"']");if(n===null){console.error("Replacelink without replacer!"),console.error(e.target);return}n.classList.remove("hidden")}function R(e){let t=a("button",{type:"button",className:"closeButton"},"X");t.addEventListener("click",()=>{e.classList.add("hidden")}),e.prepend(t)}function y(){Array.from(document.getElementsByClassName("panelOpener")).forEach(e=>{e.addEventListener("click",O)}),Array.from(document.getElementsByClassName("panelFull")).forEach(e=>{R(e)})}function h(e,t,n,i){let r=document.querySelector(".gameBg"),o=a("img",{className:"arrow",src:"assets/arrow.gif",alt:"arrow"});switch(e){case"up":o.style.transform="rotate(270deg)";break;case"down":o.style.transform="rotate(90deg)";break;case"left":o.style.transform="rotate(180deg)";break;case"right":break;default:console.error("Trying to create arrow with invalid direction: "+e);return}o.style.top=t+"%",o.style.left=n+"%",o.addEventListener("click",()=>{story.showSnippet(i)}),r.append(o)}function v(e,t,n,i,r,o){let l=document.querySelector(".gameBg"),s=a("img",{className:"npc",src:e,alt:r});s.style.top=t+"%",s.style.left=n+"%",s.style.width=i+"%",s.addEventListener("click",()=>{b(o,0)}),l.append(s)}function b(e,t){let n=e[t],i=F();k(i);let r=a("p",null,n.text);if(i.append(r),n.playerOptions!==null){i.append(a("br",null));for(let o=0;o<n.playerOptions.length;o++){let l=n.playerOptions[o],s=a("a",null,l.text);l.nextPassage!==null?s.addEventListener("click",()=>{b(e,l.nextPassage)}):s.addEventListener("click",()=>{i.remove()}),i.append(s),o<n.playerOptions.length-1&&i.append(a("span",null,"\xA0|\xA0"))}}}function F(){let e=document.querySelector(".dialoguePanel");return e===null&&(e=H()),e}function H(){let e=a("div",{className:"absoluteAlign bottomHalf blackBg dialoguePanel"});return k(e),document.getElementById("iff-snippet").append(e),e}function k(e){let t=a("button",{type:"button",className:"closeButton"},"X");t.addEventListener("click",()=>{e.remove()}),e.innerHTML="",e.prepend(t)}return N(I);})();
window.mainScript = mainScript;
